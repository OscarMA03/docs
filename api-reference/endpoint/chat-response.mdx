---
title: 'Chat Response'
openapi: 'POST /chat'
---

## Chat Response

Sends messages and generates an AI response. Accepts an array of message objects with sender information, timestamps, content, and media URLs.

### Headers

<ParamField path="header" type="string" name="x-api-key" required>
  API key for authentication
</ParamField>

### Request Body

<ParamField path="body" type="object" name="requestData" required>
  Chat request data
</ParamField>

<ParamField path="body" type="string" name="bp_chat_id" required>
  Builder Prime chat identifier
</ParamField>

<ParamField path="body" type="string" name="chat_agent_id" required>
  Chat agent identifier
</ParamField>

<ParamField path="body" type="array" name="messages" required>
  Array of message objects in the conversation
</ParamField>

<ParamField path="body" type="string" name="messages[].sender_type" required>
  Sender type: CUSTOMER, AGENT, or SYSTEM
</ParamField>

<ParamField path="body" type="string" name="messages[].sender_name" required>
  Name of the message sender
</ParamField>

<ParamField path="body" type="string" name="messages[].timestamp" required>
  Message timestamp in ISO 8601 format
</ParamField>

<ParamField path="body" type="string" name="messages[].content" required>
  Message content as a string
</ParamField>

<ParamField path="body" type="array" name="messages[].media_urls">
  Array of media URL objects
</ParamField>

<ParamField path="body" type="string" name="messages[].media_urls[].url" required>
  URL of the media file
</ParamField>

<ParamField path="body" type="string" name="messages[].media_urls[].image_flag" required>
  Whether the media is an image: TRUE or FALSE
</ParamField>

### Example Request

```bash
POST /chat 
Content-Type: application/json
x-api-key: your_api_key_here

{
  "bp_chat_id": "4",
  "chat_agent_id": "1",
  "messages": [
    {
      "sender_type": "CUSTOMER",
      "sender_name": "John Doe",
      "timestamp": "2024-01-15T10:30:00Z",
      "content": "Hello, I'd like to schedule an appointment",
      "media_urls": []
    },
    {
      "sender_type": "AGENT",
      "sender_name": "Sally",
      "timestamp": "2024-01-15T10:32:00Z",
      "content": "Hi! I'd be happy to help you schedule an appointment. What service are you interested in?",
      "media_urls": []
    },
    {
      "sender_type": "CUSTOMER",
      "sender_name": "John Doe",
      "timestamp": "2024-01-15T10:35:00Z",
      "content": "I need a consultation for my business",
      "media_urls": [
        {
          "url": "https://example.com/document.pdf",
          "image_flag": "FALSE"
        }
      ]
    },
    {
      "sender_type": "CUSTOMER",
      "sender_name": "John Doe",
      "timestamp": "2024-01-15T10:36:00Z",
      "content": "no",
      "media_urls": []
    }
  ]
}
```

### Example Response

```json
{
  "success": true,
  "data": {
    "retell_chat_id": "chat_bd9173ad49a2ca7b44aad0a03f4",
    "bp_chat_id": "4",
    "found": true,
    "completion": {
      "messages": [
        {
          "message_id": "message_6af90f699587b580cacf82e9",
          "role": "agent",
          "created_timestamp": 1761781923966,
          "content": "Thanks so much for calling, Oscar. We look forward to seeing you for your consultation. Have a great day!"
        }
      ]
    }
  },
  "error": null
}
```

### Response Fields

<ParamField path="response" type="boolean" name="success">
  Indicates if the request was successful
</ParamField>

<ParamField path="response" type="object" name="data">
  Response data object
</ParamField>

<ParamField path="response" type="string" name="data.retell_chat_id">
  Retell chat identifier
</ParamField>

<ParamField path="response" type="string" name="data.bp_chat_id">
  Builder Prime chat identifier
</ParamField>

<ParamField path="response" type="boolean" name="data.found">
  Indicates if the chat conversation was found
</ParamField>

<ParamField path="response" type="object" name="data.completion">
  Completion object containing AI-generated messages
</ParamField>

<ParamField path="response" type="array" name="data.completion.messages">
  Array of message objects from the AI agent
</ParamField>

<ParamField path="response" type="string" name="data.completion.messages[].message_id">
  Unique identifier for the message
</ParamField>

<ParamField path="response" type="string" name="data.completion.messages[].role">
  Role of the message sender (e.g., "agent")
</ParamField>

<ParamField path="response" type="integer" name="data.completion.messages[].created_timestamp">
  Unix timestamp when the message was created
</ParamField>

<ParamField path="response" type="string" name="data.completion.messages[].content">
  The AI-generated message content
</ParamField>

### Error Response

```json
{
  "success": false,
  "data": null,
  "error": "Failed to generate AI response"
}
```

### Use Cases

- **AI-Powered Customer Service**: Generate context-aware AI responses based on conversation history
- **Conversation Continuity**: Maintain natural conversation flow with AI assistance
- **Lead Qualification**: AI can analyze conversation history and ask qualifying questions
- **Real-time Support**: Provide instant, context-aware responses to customer inquiries

### Implementation Notes

- The endpoint accepts an array of message objects representing the conversation history
- Messages should be ordered chronologically (oldest first, with the most recent message at the end)
- `sender_type` must be one of: CUSTOMER, AGENT, or SYSTEM
- `timestamp` must be in ISO 8601 format
- `image_flag` must be either "TRUE" or "FALSE" as a string
- Media URLs can be empty arrays if no media is attached
- Consider implementing rate limiting for AI response generation
